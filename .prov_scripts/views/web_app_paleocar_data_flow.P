

%---------------------------------------------------------------------------------------------------
% FACT: yw_source_file(SourceId, SourceFile).
%...................................................................................................
yw_source_file(1,'web_app_paleocar_data_flow.R').


%---------------------------------------------------------------------------------------------------
% FACT: yw_workflow_script(WorkflowId, WorkflowName, SourceId, SourceFile).
%...................................................................................................
yw_workflow_script(1,exec_paleocar,1,'web_app_paleocar_data_flow.R').


%---------------------------------------------------------------------------------------------------
% FACT: yw_program(WorkflowId, ProgramName, WorkflowId, SourceId, BeginLine, EndLine).
%...................................................................................................
yw_program(1,exec_paleocar,nil,1,2,66).
yw_program(2,get_user_input,1,1,20,26).
yw_program(3,extract_prism_data,1,1,28,34).
yw_program(4,gen_paleocar_model,1,1,36,45).
yw_program(5,extract_prediction_model,1,1,48,54).
yw_program(6,extract_uncertainty_model,1,1,57,64).


%---------------------------------------------------------------------------------------------------
% FACT: yw_workflow(WorkflowId, WorkflowName, ParentWorkflowId, SourceId, BeginLine, EndLine).
%...................................................................................................
yw_workflow(1,exec_paleocar,nil,1,2,66).


%---------------------------------------------------------------------------------------------------
% FACT: yw_workflow_step(StepId, StepName, WorkflowId, SourceId, BeginLine, EndLine).
%...................................................................................................
yw_workflow_step(2,get_user_input,1,1,20,26).
yw_workflow_step(3,extract_prism_data,1,1,28,34).
yw_workflow_step(4,gen_paleocar_model,1,1,36,45).
yw_workflow_step(5,extract_prediction_model,1,1,48,54).
yw_workflow_step(6,extract_uncertainty_model,1,1,57,64).


%---------------------------------------------------------------------------------------------------
% FACT: yw_function(FunctionId, FunctionName, ParentWorkflowId, SourceId, BeginLine, EndLine).
%...................................................................................................


%---------------------------------------------------------------------------------------------------
% FACT: yw_data(DataId, DataName, WorkflowId, WorkflowName).
%...................................................................................................
yw_data(1,user_map_marker_pos,nil,nil).
yw_data(2,user_prediction_years,nil,nil).
yw_data(3,prism_data,nil,nil).
yw_data(4,itrdb,nil,nil).
yw_data(5,calibration_year,nil,nil).
yw_data(6,label,nil,nil).
yw_data(7,paleocar_models,nil,nil).
yw_data(8,prediction_model,nil,nil).
yw_data(9,uncertainty_model,nil,nil).
yw_data(10,prediction_plot,nil,nil).
yw_data(11,uncertainty_plot,nil,nil).
yw_data(12,paleocar_model_log_file,nil,nil).
yw_data(13,user_map_marker_pos,1,exec_paleocar).
yw_data(14,user_prediction_years,1,exec_paleocar).
yw_data(15,coordinates,1,exec_paleocar).
yw_data(16,prediction_years,1,exec_paleocar).
yw_data(17,prism_data,1,exec_paleocar).
yw_data(18,prism_data_for_coordinates,1,exec_paleocar).
yw_data(19,label,1,exec_paleocar).
yw_data(20,calibration_year,1,exec_paleocar).
yw_data(21,itrdb,1,exec_paleocar).
yw_data(22,paleocar_models,1,exec_paleocar).
yw_data(23,paleocar_model_log_file,1,exec_paleocar).
yw_data(24,prediction_model,1,exec_paleocar).
yw_data(25,prediction_plot,1,exec_paleocar).
yw_data(26,uncertainty_model,1,exec_paleocar).
yw_data(27,uncertainty_plot,1,exec_paleocar).


%---------------------------------------------------------------------------------------------------
% FACT: yw_step_input(ProgramId, ProgramName, PortType, PortId, PortName, DataId, DataName).
%...................................................................................................
yw_step_input(6,extract_uncertainty_model,in,32,'prediction.year',16,prediction_years).
yw_step_input(6,extract_uncertainty_model,in,31,paleocar_models,22,paleocar_models).
yw_step_input(5,extract_prediction_model,in,28,'prediction.year',16,prediction_years).
yw_step_input(5,extract_prediction_model,in,27,paleocar_models,22,paleocar_models).
yw_step_input(4,gen_paleocar_model,param,22,itrdb,21,itrdb).
yw_step_input(4,gen_paleocar_model,param,21,cal_year,20,calibration_year).
yw_step_input(4,gen_paleocar_model,param,20,label,19,label).
yw_step_input(4,gen_paleocar_model,in,24,predictands,18,prism_data_for_coordinates).
yw_step_input(4,gen_paleocar_model,in,23,prediction_year,16,prediction_years).
yw_step_input(3,extract_prism_data,param,18,spatial_file,17,prism_data).
yw_step_input(3,extract_prism_data,in,17,coordinates,15,coordinates).
yw_step_input(2,get_user_input,in,14,prediction_year,14,user_prediction_years).
yw_step_input(2,get_user_input,in,13,coordinates,13,user_map_marker_pos).
yw_step_input(1,exec_paleocar,param,6,label,6,label).
yw_step_input(1,exec_paleocar,param,5,calibration_year,5,calibration_year).
yw_step_input(1,exec_paleocar,param,4,itrdb,4,itrdb).
yw_step_input(1,exec_paleocar,param,3,prism_data,3,prism_data).
yw_step_input(1,exec_paleocar,in,2,user_prediction_years,2,user_prediction_years).
yw_step_input(1,exec_paleocar,in,1,user_map_marker_pos,1,user_map_marker_pos).


%---------------------------------------------------------------------------------------------------
% FACT: yw_step_output(ProgramId, ProgramName, PortType, PortId, PortName, DataId, DataName).
%...................................................................................................
yw_step_output(1,exec_paleocar,out,7,paleocar_models,7,paleocar_models).
yw_step_output(1,exec_paleocar,out,8,prediction_model,8,prediction_model).
yw_step_output(1,exec_paleocar,out,9,uncertainty_model,9,uncertainty_model).
yw_step_output(1,exec_paleocar,out,10,prediction_plot,10,prediction_plot).
yw_step_output(1,exec_paleocar,out,11,uncertainty_plot,11,uncertainty_plot).
yw_step_output(1,exec_paleocar,out,12,paleocar_model_log_file,12,paleocar_model_log_file).
yw_step_output(2,get_user_input,out,15,coordinates,15,coordinates).
yw_step_output(2,get_user_input,out,16,prediction_year,16,prediction_years).
yw_step_output(3,extract_prism_data,out,19,prism_data_for_coordinates,18,prism_data_for_coordinates).
yw_step_output(4,gen_paleocar_model,out,25,paleocar_models,22,paleocar_models).
yw_step_output(4,gen_paleocar_model,out,26,log_file,23,paleocar_model_log_file).
yw_step_output(5,extract_prediction_model,out,29,prediction_model,24,prediction_model).
yw_step_output(5,extract_prediction_model,out,30,plot,25,prediction_plot).
yw_step_output(6,extract_uncertainty_model,out,33,model,26,uncertainty_model).
yw_step_output(6,extract_uncertainty_model,out,34,plot,27,uncertainty_plot).


%---------------------------------------------------------------------------------------------------
% FACT: yw_inflow(WorkflowId, WorkflowName, DataId, DataName, ProgramId, ProgramName).
%...................................................................................................
yw_inflow(1,exec_paleocar,21,itrdb,4,gen_paleocar_model).
yw_inflow(1,exec_paleocar,20,calibration_year,4,gen_paleocar_model).
yw_inflow(1,exec_paleocar,19,label,4,gen_paleocar_model).
yw_inflow(1,exec_paleocar,17,prism_data,3,extract_prism_data).
yw_inflow(1,exec_paleocar,14,user_prediction_years,2,get_user_input).
yw_inflow(1,exec_paleocar,13,user_map_marker_pos,2,get_user_input).


%---------------------------------------------------------------------------------------------------
% FACT: yw_flow(SourceProgramId, SourceProgramName, SourcePortId, SourcePortName, DataId, DataName, SinkPortId, SinkPortName, SinkProgramId, SinkProgramName).
%...................................................................................................
yw_flow(2,get_user_input,15,coordinates,15,coordinates,17,coordinates,3,extract_prism_data).
yw_flow(2,get_user_input,16,prediction_year,16,prediction_years,32,'prediction.year',6,extract_uncertainty_model).
yw_flow(2,get_user_input,16,prediction_year,16,prediction_years,28,'prediction.year',5,extract_prediction_model).
yw_flow(2,get_user_input,16,prediction_year,16,prediction_years,23,prediction_year,4,gen_paleocar_model).
yw_flow(3,extract_prism_data,19,prism_data_for_coordinates,18,prism_data_for_coordinates,24,predictands,4,gen_paleocar_model).
yw_flow(4,gen_paleocar_model,25,paleocar_models,22,paleocar_models,31,paleocar_models,6,extract_uncertainty_model).
yw_flow(4,gen_paleocar_model,25,paleocar_models,22,paleocar_models,27,paleocar_models,5,extract_prediction_model).


%---------------------------------------------------------------------------------------------------
% FACT: yw_outflow(StepId, StepName, StepOutDataId, StepOutDataName, WorkflowId, WorkflowName, WorkflowOutDataId, WorkflowOutDataName).
%...................................................................................................
yw_outflow(4,gen_paleocar_model,22,paleocar_models,1,exec_paleocar,7,paleocar_models).
yw_outflow(5,extract_prediction_model,24,prediction_model,1,exec_paleocar,8,prediction_model).
yw_outflow(6,extract_uncertainty_model,26,uncertainty_model,1,exec_paleocar,9,uncertainty_model).
yw_outflow(5,extract_prediction_model,25,prediction_plot,1,exec_paleocar,10,prediction_plot).
yw_outflow(6,extract_uncertainty_model,27,uncertainty_plot,1,exec_paleocar,11,uncertainty_plot).
yw_outflow(4,gen_paleocar_model,23,paleocar_model_log_file,1,exec_paleocar,12,paleocar_model_log_file).


%---------------------------------------------------------------------------------------------------
% FACT: yw_qualified_name(EntityType, Id, QualifiedName).
%...................................................................................................
yw_qualified_name(program,1,exec_paleocar).
yw_qualified_name(program,2,'exec_paleocar.get_user_input').
yw_qualified_name(program,3,'exec_paleocar.extract_prism_data').
yw_qualified_name(program,4,'exec_paleocar.gen_paleocar_model').
yw_qualified_name(program,5,'exec_paleocar.extract_prediction_model').
yw_qualified_name(program,6,'exec_paleocar.extract_uncertainty_model').
yw_qualified_name(port,1,'exec_paleocar<-user_map_marker_pos').
yw_qualified_name(port,2,'exec_paleocar<-user_prediction_years').
yw_qualified_name(port,3,'exec_paleocar<-prism_data').
yw_qualified_name(port,4,'exec_paleocar<-itrdb').
yw_qualified_name(port,5,'exec_paleocar<-calibration_year').
yw_qualified_name(port,6,'exec_paleocar<-label').
yw_qualified_name(port,7,'exec_paleocar->paleocar_models').
yw_qualified_name(port,8,'exec_paleocar->prediction_model').
yw_qualified_name(port,9,'exec_paleocar->uncertainty_model').
yw_qualified_name(port,10,'exec_paleocar->prediction_plot').
yw_qualified_name(port,11,'exec_paleocar->uncertainty_plot').
yw_qualified_name(port,12,'exec_paleocar->paleocar_model_log_file').
yw_qualified_name(port,13,'exec_paleocar.get_user_input<-coordinates').
yw_qualified_name(port,14,'exec_paleocar.get_user_input<-prediction_year').
yw_qualified_name(port,15,'exec_paleocar.get_user_input->coordinates').
yw_qualified_name(port,16,'exec_paleocar.get_user_input->prediction_year').
yw_qualified_name(port,17,'exec_paleocar.extract_prism_data<-coordinates').
yw_qualified_name(port,18,'exec_paleocar.extract_prism_data<-spatial_file').
yw_qualified_name(port,19,'exec_paleocar.extract_prism_data->prism_data_for_coordinates').
yw_qualified_name(port,20,'exec_paleocar.gen_paleocar_model<-label').
yw_qualified_name(port,21,'exec_paleocar.gen_paleocar_model<-cal_year').
yw_qualified_name(port,22,'exec_paleocar.gen_paleocar_model<-itrdb').
yw_qualified_name(port,23,'exec_paleocar.gen_paleocar_model<-prediction_year').
yw_qualified_name(port,24,'exec_paleocar.gen_paleocar_model<-predictands').
yw_qualified_name(port,25,'exec_paleocar.gen_paleocar_model->paleocar_models').
yw_qualified_name(port,26,'exec_paleocar.gen_paleocar_model->log_file').
yw_qualified_name(port,27,'exec_paleocar.extract_prediction_model<-paleocar_models').
yw_qualified_name(port,28,'exec_paleocar.extract_prediction_model<-prediction.year').
yw_qualified_name(port,29,'exec_paleocar.extract_prediction_model->prediction_model').
yw_qualified_name(port,30,'exec_paleocar.extract_prediction_model->plot').
yw_qualified_name(port,31,'exec_paleocar.extract_uncertainty_model<-paleocar_models').
yw_qualified_name(port,32,'exec_paleocar.extract_uncertainty_model<-prediction.year').
yw_qualified_name(port,33,'exec_paleocar.extract_uncertainty_model->model').
yw_qualified_name(port,34,'exec_paleocar.extract_uncertainty_model->plot').
yw_qualified_name(data,1,'[user_map_marker_pos]').
yw_qualified_name(data,2,'[user_prediction_years]').
yw_qualified_name(data,3,'[prism_data]').
yw_qualified_name(data,4,'[itrdb]').
yw_qualified_name(data,5,'[calibration_year]').
yw_qualified_name(data,6,'[label]').
yw_qualified_name(data,7,'[paleocar_models]').
yw_qualified_name(data,8,'[prediction_model]').
yw_qualified_name(data,9,'[uncertainty_model]').
yw_qualified_name(data,10,'[prediction_plot]').
yw_qualified_name(data,11,'[uncertainty_plot]').
yw_qualified_name(data,12,'[paleocar_model_log_file]').
yw_qualified_name(data,13,'exec_paleocar[user_map_marker_pos]').
yw_qualified_name(data,14,'exec_paleocar[user_prediction_years]').
yw_qualified_name(data,15,'exec_paleocar[coordinates]').
yw_qualified_name(data,16,'exec_paleocar[prediction_years]').
yw_qualified_name(data,17,'exec_paleocar[prism_data]').
yw_qualified_name(data,18,'exec_paleocar[prism_data_for_coordinates]').
yw_qualified_name(data,19,'exec_paleocar[label]').
yw_qualified_name(data,20,'exec_paleocar[calibration_year]').
yw_qualified_name(data,21,'exec_paleocar[itrdb]').
yw_qualified_name(data,22,'exec_paleocar[paleocar_models]').
yw_qualified_name(data,23,'exec_paleocar[paleocar_model_log_file]').
yw_qualified_name(data,24,'exec_paleocar[prediction_model]').
yw_qualified_name(data,25,'exec_paleocar[prediction_plot]').
yw_qualified_name(data,26,'exec_paleocar[uncertainty_model]').
yw_qualified_name(data,27,'exec_paleocar[uncertainty_plot]').


%---------------------------------------------------------------------------------------------------
% FACT: yw_description(EntityType, Id, Name, Description)).
%...................................................................................................
yw_description(program,2,get_user_input,'Get coordinates and years for predicting the model from the web app user.').
yw_description(program,3,extract_prism_data,'Load the prism data file with precipitation values and extract the data for the input coordinates and save as a csv file.').
yw_description(program,4,gen_paleocar_model,'generate paleocar models for predicting the climate for the given years.').
yw_description(program,5,extract_prediction_model,'extract the rasterbrick reconstruction from a PaleoCAR batch model for the specified prediction period.').
yw_description(program,6,extract_uncertainty_model,'extract the LOOCV uncertainty information from the set of Paleocar models for specified period.').
yw_description(port,1,user_map_marker_pos,'Coordinates of location for reconstruction of paleoclimate.').
yw_description(port,2,user_prediction_years,'Prediction years for reconstruction of paleoclimate.').
yw_description(port,3,prism_data,'file containing the precipitation values for the particular region').
yw_description(port,4,itrdb,'tree ring chronologies database').
yw_description(port,5,calibration_year,'period for calibrating the information for predicting the climate.').
yw_description(port,6,label,'a user label for the generated paleocar model of the study region.').
yw_description(port,7,paleocar_models,'R model of the paleocar reconstruction.').
yw_description(port,8,prediction_model,'R model of the paleocar reconstruction of prediction.').
yw_description(port,9,uncertainty_model,'R model of the paleocar reconstruction of uncertainties.').
yw_description(port,10,prediction_plot,'timeseries plot of prediction model of the paleocar reconstruction.').
yw_description(port,11,uncertainty_plot,'timeseries plot of uncertainty model of the paleocar reconstruction.').
yw_description(port,12,paleocar_model_log_file,'a log file containing information about the execution of paleocar reconstruction.').
yw_description(port,13,coordinates,'Coordinates of location for reconstruction of paleoclimate.').
yw_description(port,14,prediction_year,'Prediction years for reconstruction of paleoclimate.').
yw_description(port,15,coordinates,'Coordinates of location for reconstruction of paleoclimate.').
yw_description(port,16,prediction_year,'Prediction years for reconstruction of paleoclimate.').
yw_description(port,17,coordinates,'Coordinates of location for reconstruction of paleoclimate.').
yw_description(port,18,spatial_file,'file containing the precipitation values for the particular region.').
yw_description(port,19,prism_data_for_coordinates,'file containing the precipitation values for the selected region.').
yw_description(port,20,label,'user entered label for the study region.').
yw_description(port,21,cal_year,'period for calibrating the information for predicting the climate.').
yw_description(port,22,itrdb,'tree ring chronologies database').
yw_description(port,23,prediction_year,'An optional integer vector of years for the reconstruction.').
yw_description(port,24,predictands,'A RasterBrick, RasterStack, matrix, or vector of the numeric predictand (response) variable.').
yw_description(port,25,paleocar_models,'R model of the paleocar reconstruction of prediction.').
yw_description(port,26,log_file,'a log file containing information about the execution of paleocar reconstruction.').
yw_description(port,27,paleocar_models,'R model of the paleocar reconstruction.').
yw_description(port,28,'prediction.year','Prediction years for reconstruction of paleoclimate.').
yw_description(port,29,prediction_model,'R model of the paleocar reconstruction of prediction.').
yw_description(port,30,plot,'timeseries plot of prediction model of the paleocar reconstruction.').
yw_description(port,31,paleocar_models,'R model of the paleocar reconstruction.').
yw_description(port,31,paleocar_models,'R model of the paleocar reconstruction.').
yw_description(port,32,'prediction.year','Prediction years for reconstruction of paleoclimate.').
yw_description(port,33,model,'R model of the paleocar reconstruction of uncertainties.').
yw_description(port,34,plot,'timeseries plot of uncertainty model of the paleocar reconstruction.').
