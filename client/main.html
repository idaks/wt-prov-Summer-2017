<head>
  <title>PaleoCar</title>
</head>

<!-- 
  Home Page template for displaying the PaleoCar background 
  and static images for the result of the earlier Paleocar execution.
-->
<template name="home">
  <div class="container">
    {{> Nav}}
    <div class="section">
      <table>
        <tbody>
          <tr>
            <td>
              <h5>What is PaleoCar?</h5>
            </td>
          </tr>
          <tr>
            <td class=h4>
              PaleoCar is an R package implementing functions to perform spatio-temporal paleoclimate reconstruction from tree-rings using the CAR (Correlation Adjusted corRelation) approach of Zuber and Strimmer as implemented in the care package for R.       
            </td>
          </tr>
          <tr>
            <td class=h4>
              It is optimized for speed and memory use. This is based on the approach used in Bocinsky and Kohler (2014):
              <p class=h4>
              Bocinsky, R. K. and Kohler, T. A. (2014). A 2,000-year reconstruction of the rain-fed maize agricultural niche in the US Southwest. Nature Communications, 5:5618. doi: <a href="">10.1038/ncomms6618 </a>.
              </p>  
            </td>
          </tr>
          <tr >
            <td class=h4>
              <b> Development </b>
              <ul>
                <li> <a href=http://bocinsky.io/> Kyle Bocinsky </a> - Crow Canyon Archaeological Center, Cortez, CO </li>
              </ul>
            </td>
          </tr>
          <tr>
            <td class = h4>
              <b> Install paleocar </b>
              <ul>
                <li> For installing and running Paleocar manually in R, you may refer to the <a href=https://github.com/bocinsky/paleocar> Github. </a> 
                </li>
              </ul> 
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="section">
      {{> pc_images}}
    </div>
  </div>
</template>

<!-- 
  Template for creation of the navigation grid on the top of the page
-->
<template name="Nav">
  <div class="topnav" id="myTopnav">
    <a href="/">Home</a>
    <a href="/execpaleocar">Execute PaleoCar</a>
    <a href="/provenance">Provenance</a>
    <a href="/contactus">Contact Us</a>
  </div>
</template>


<!-- 
  Template for diaplying of the images of the Paleocar result
-->
<template name="pc_images">

    <div class="card-panel hoverable">    
    <table>
      <tr>
        <td>
          <img src="/images/raster_pred_ppt_vs_pred_years.jpeg" style="width:350px;height:400px;">
        </td>
        <td>
          <img src="/images/raster_uncer_ppt_vs_pred_years.jpeg" style="width:350px;height:400px;">
        </td>
      </tr>
      <tr>
        <td>
          <img src="/images/matrix_pred_ppt_vs_pred_years.jpeg" style="width:350px;height:400px;">
        </td>
        <td>
          <img src="/images/matrix_uncer_ppt_vs_pred_years.jpeg" style="width:350px;height:400px;">
        </td>
      </tr> 
      <tr>
        <td>
          <img src="/images/vector_pred_ppt_vs_pred_years.jpeg" style="width:350px;height:400px;">
        </td>
        <td>
          <img src="/images/vector_uncer_ppt_vs_pred_years.jpeg" style="width:350px;height:400px;">
        </td>
      </tr> 
    </table>
  </div>

</template>          

<!-- 
  Template for displaying the map on the ExecutePaleocar template.
-->
<template name="map">
 <div class="card-panel hoverable">
  <!-- 
  This calls for the template which populates the lat and long values
  from the marker and displays for the user. 
  -->
  {{> pop_lat_lng}} 
    <div class="map-container">        
      {{#unless geolocationError}}
        {{> googleMap name="map" options=mapOptions}}
      {{else}}
        Geolocation failed: {{geolocationError}}
      {{/unless}}
   </div>
  </div>
</template>  

<!-- 
  Template for  populating the current lat and long values set by marker
-->
<template name="pop_lat_lng">
  <table>
    <tr>
      <td> <b> Latitude: </b></td>
      <td> {{txt_lat}} </td>
      <td> <b>Longitude:  </b></td>
      <td>   {{txt_lng}} </td>
      <td> <b>Region Of Interest:  </b></td>
      <td> {{txt_ROI}}</td>
      <td> <b>RunId:  </b></td>
      <td> {{txt_runid}}</td>
    </tr>
  </table> 
</template>

<!-- 
  Template for executing the paleocar. 
  This has an event associated with the button 
-->
<template name="btn_exec_paleocar">
  <table>
    <tr>
      <td>
        <button class="exec_PaleoCar"> Execute PaleoCar. </button>  
      </td>
    </tr>
  </table>    
</template>
 

<template name="btn_show_provenance">
  <table>
    <tr>
      <td>
        <button class="dis_prov_img"> Prospective Provenance.  </button>  
      </td>
    </tr>
  </table>          
</template>

<!-- 
  This template is used for execution of the paleocar. 
  It internally calls the map, btn_exec_paleocar and res_img templates. 
-->
<template name="execpaleocar">
  <div class="container">
    {{> Nav}}
    <div class="section">
        <p class="h3"> Execute PaleoCar </p>
        <p class="h5"> Steps for Executing PaleoCar. <br></p>
        <p class=h5>
          1. Select region from the map. <br> 
          2. Click "Execute PaleoCar Button". <br>
        </p>
        <p> The result of the execution will be displayed below. <br> </p>
        <p> The Provenance information is available on the provenance tab for the execution. <br> </p>
    </div>
    <div class=divider></div>
    <p class="h5"> Prediction Years: </p><input type="text" id="prediction_year" value={{prediction_years}}> 

    {{> btn_show_provenance}}
    
    {{#if show_pros_prov_img}}
      <img src="/prospective_prov_img/data_flow.jpg" style="width:350;height:400px;" align="middle"> 
    {{/if }}
    
    <div class="container">
      {{> map}}
   
    {{#if wait_img}}
      <div class="floating"> 
       {{> dis_pros_prov_img}}
      </div>
    {{/if}}
   
    </div>
     {{> btn_exec_paleocar}}
     {{> res_img}}
    
  </div>
</template>


<!-- 
  This template is used for displaying the provenance 
-->
<template name="provenance">
<div class="container">
    {{> Nav}}
    <!-- <img src="paleocar_model.png"  style="width:800px;height:300px;"> -->
    <p> <b> RunId : {{dis_run_id}} </b> </p>
   <!--  {{> btn_show_provenance}}    -->
   <div  class="card-panel hoverable">
    <table>
    <tr>
      <img src=/prospective_prov_img/paleocar_data_flow.png style="width:850px;height:250px;">
    </tr>
    <tr>
      <img src=/prospective_prov_img/get_itrdb_data.png style="width:600px;height:300px;">
    </tr>
    <tr>
      <img src=/prospective_prov_img/get_prism_data.png style="width:600px;height:300px;">
    </tr>
    <tr>
      <img src=/prospective_prov_img/paleocar_models_provenance.png style="width:830px;height:  300px;">
    </tr>
    <tr>
      <img src=/prospective_prov_img/predict_paleocar_models.png style="width:600px;height:300px;">
    </tr>
    <tr>
      <img src=/prospective_prov_img/uncertainty_paleocar_models.png style="width:600px;height:300px;">
    </tr>

<!--
    <tr>
     <td>
       {{#each show_prov_img}}
        <li>
          {{name}} 
          <img src="{{image_data}}"  style="width:700px;height:300px;">
        </li>
      {{/each}} 

    </td> 
-->
<!--     
    <td>
      <ul>
      {{#each show_dir_struture}}
        <li>
            {{name}} : {{path}}  
        </li>
        {{/each}} 
      </ul>          
    </td>
   
    </tr>
-->
    </table>
  </div>
</div>
</template>


<!-- 
  This template is used for displaying the contact information if needed. 
-->
<template name="contactus">
  <div class="container">
    {{> Nav}}
    <p> THis page is for contact us.</p> 
  </div>
</template>


<!-- 
  This template is used for displaying the result of the paleocar execution. 
  It is only enabled when the showFullContent reactive variable is set to true. 
-->
<template name="res_img">
{{#if show_res_img}}  
  <div class="card-panel hoverable">   
    <table>
      <tr>
        <td>
          <ul>
          {{#each show_image}}
          <li>
            <tr>
            <p> <b> Result of the run: </b> {{run_count}} </p>
            
            </tr>
            <img src="{{img_prediction}}"  style="width:350px;height:400px;">
            <img src="{{img_uncertainty}}" style="width:350px;height:400px;">
          </li>
            {{/each}} 
          </ul>
           <!-- <img src="{{ show_image }}" style="width:350px;height:400px;"> -->
          <!-- {{> myLineChart }} -->
        </td>
      </tr>
    </table>
  </div>
{{/if}}
</template>

<template name="acTemplate">
    <div id="chartcontainer"></div>
</template>

<template name='myLineChart'>
   <canvas id="myLineChart" width="400" height="200"></canvas>
</template>


<template name='run_result_tbl'>
  <div>
    <ul>
    {{#each run_log_info}}
      <li>
          {{label}}
          {{run_time}}
          {{DateTime}} 
      </li>
      {{/each}} 
    </ul>
  </div>
</template> 
 

<template name='dis_pros_prov_img' >
  <img src="/prospective_prov_img/paleocar_data_flow.gif" style="width:350;height:400px;"> 
</template>